_target_: src.models.cmo.UnetModule
 
loss:
  _target_: torch.nn.L1Loss

net:
  _target_: src.models.components.channel_net.Channel_Net
  configs:
    name: "Unet"  # from segmentation_models_pytorch
    pre_seq_length: 6
    aft_seq_length: 12
    args: 
        encoder_name: "resnet34"
        encoder_weights: "imagenet"
        in_channels: 12
        classes: 24
        activation: null

hparams:
  TRAIN:
    EPOCHS: 300 #${trainer.max_steps}
    INTERVAL: step #step #epoch
    MONITOR: val/loss #'val/.F1_1'
    WARMUP_EPOCHS: 0
    BASE_LR: 0.0003
    T_IN_EPOCHS: true
    WARMUP_LR: 1.0e-07
    MIN_LR: 1.0e-07 # 6e-5
    WEIGHT_DECAY: 0.001
    OPTIMIZER:
      NAME: admw #sgd
      MOMENTUM: 0.9
      EPS: 1.0e-08
      BETAS:
      - 0.9
      - 0.999
    LR_SCHEDULER:
      NAME: linear #on_plateau #linear
      DECAY_RATE: 0.1
      DECAY_EPOCHS: 6
      MODE: max
      PATIENCE: 10
      GAMMA: 0.5 #0.9 #0.3 #0.999
